<nav><ul><li><a href="/">TinyTick</a></li><li><a href="/guides/">Guides</a></li><li><a href="/guides/advanced-usage/">Advanced Usage</a></li><li><a href="/guides/advanced-usage/starting-and-stopping/">Starting And Stopping</a></li></ul></nav><section class="s1" id="/guides/advanced-usage/starting-and-stopping/" data-id="SAS"><h1>Starting And Stopping</h1><p>We finish with a relatively simple topic, but one that has some important behaviors worth mentioning.</p><h3 id="the-manager-is-stopped-by-default">The <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a> is stopped by default</h3><p>When you create a <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a> object, it is stopped. This means that it will not start its tick sequence, and so will not run any tasks until you explicitly start it. This is useful if you want to do some setup (such as registering tasks) before you start running any at all.</p><pre><code><span class="keyword">import</span> <span class="punctuation">{</span>createManager<span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">'tinytick'</span><span class="punctuation">;</span>

<span class="keyword">const</span> stoppedManager <span class="operator">=</span> <span class="function"><a href="/api/tinytick/functions/creation/createmanager/">createManager</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>stoppedManager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/lifecycle/getstatus/">getStatus</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> 0 /* stopped */</span>
</code></pre><p>One common pattern is to create the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a>, register tasks, and then start it using the <a href="/api/tinytick/interfaces/manager/manager/methods/lifecycle/start/"><code>start</code></a> method, possibly all in a single fluent statement:</p><pre><code><span class="keyword">const</span> manager <span class="operator">=</span> <span class="function"><a href="/api/tinytick/functions/creation/createmanager/">createManager</a></span><span class="punctuation">(</span><span class="punctuation">)</span>
  <span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/task/settask/">setTask</a></span><span class="punctuation">(</span><span class="string">'hello'</span><span class="punctuation">,</span> <span class="keyword">async</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span><span class="string">'Hello!'</span><span class="punctuation">)</span><span class="punctuation">)</span>
  <span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/task/settask/">setTask</a></span><span class="punctuation">(</span><span class="string">'ping'</span><span class="punctuation">,</span> <span class="keyword">async</span> <span class="punctuation">(</span><span class="parameter">url</span><span class="punctuation">)</span> <span class="operator">=></span> <span class="function">fetch</span><span class="punctuation">(</span>url<span class="punctuation">)</span><span class="punctuation">)</span>
  <span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/lifecycle/start/">start</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><h3 id="stopping-the-manager">Stopping the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a></h3><p>As you might guess, the <a href="/api/tinytick/interfaces/manager/manager/methods/lifecycle/stop/"><code>stop</code></a> method is responsible for stopping the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a>. This will halt the tick sequence, and so no further tasks will be run until you start the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a> again.</p><p>This is an important clean up step up in your application since the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a> maintains timeout handles that might (in the case of a Node app for example) keep the process alive indefinitely.</p><p>But it&#x27;s important to note that there are two ways to stop the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a>. By default, it won&#x27;t stop immediately, and will wait until all scheduled tasks have been run.</p><p>This will start the &#x27;hello&#x27; task in 200ms&#x27; time:</p><pre><code>manager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/taskrun/scheduletaskrun/">scheduleTaskRun</a></span><span class="punctuation">(</span><span class="string">'hello'</span><span class="punctuation">,</span> <span class="string">''</span><span class="punctuation">,</span> <span class="number">200</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>But if the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a> is stopped, it will remain in the &#x27;stopping&#x27; status for 200ms until the task run has been executed. Only then will it be stopped:</p><pre><code>manager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/lifecycle/stop/">stop</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>manager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/lifecycle/getstatus/">getStatus</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> 2 /* stopping */</span>

<span class="comment">// ... wait 300ms to be sure the task run completes</span>
<span class="comment">// -> 'Hello!'</span>

console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>manager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/lifecycle/getstatus/">getStatus</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> 0 /* stopped */</span>
</code></pre><h3 id="stopping-immediately">Stopping immediately</h3><p>If this is undesirable, you can force the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a> to stop immediately by passing <code>true</code> into the <a href="/api/tinytick/interfaces/manager/manager/methods/lifecycle/stop/"><code>stop</code></a> method:</p><pre><code>manager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/lifecycle/start/">start</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span> <span class="comment">// start it again</span>

manager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/taskrun/scheduletaskrun/">scheduleTaskRun</a></span><span class="punctuation">(</span><span class="string">'hello'</span><span class="punctuation">,</span> <span class="string">''</span><span class="punctuation">,</span> <span class="number">200</span><span class="punctuation">)</span><span class="punctuation">;</span>
manager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/lifecycle/stop/">stop</a></span><span class="punctuation">(</span><span class="boolean">true</span><span class="punctuation">)</span><span class="punctuation">;</span>

console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>manager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/lifecycle/getstatus/">getStatus</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> 0 /* stopped */</span>
</code></pre><p>This won&#x27;t kill any tasks that are currently running, but it will prevent any future scheduled task runs from starting.</p><p>Note however, that regardless of how you stop the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a>, scheduled task runs will remain in the queue, and will get executed again when it starts up.</p><pre><code>console<span class="punctuation">.</span><span class="function">log</span><span class="punctuation">(</span>manager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/taskrun/getscheduledtaskrunids/">getScheduledTaskRunIds</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span>length<span class="punctuation">)</span><span class="punctuation">;</span>
<span class="comment">// -> 1</span>

manager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/lifecycle/start/">start</a></span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>

<span class="comment">// ... wait 300ms to be sure the task run completes</span>
<span class="comment">// -> 'Hello!'</span>
</code></pre><h3 id="you-can-t-schedule-task-runs-when-the-manager-is-stopping">You can&#x27;t schedule task runs when the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a> is stopping</h3><p>Finally, it&#x27;s important to note that while the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a> is in its &#x27;stopping&#x27; state, no new task runs can be scheduled. This for the case in which a task recursively schedules a new run of itself. Consider this:</p><pre><code>manager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/task/settask/">setTask</a></span><span class="punctuation">(</span><span class="string">'recurse'</span><span class="punctuation">,</span> <span class="keyword">async</span> <span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">=></span> manager<span class="punctuation">.</span><span class="function"><a href="/api/tinytick/interfaces/manager/manager/methods/taskrun/scheduletaskrun/">scheduleTaskRun</a></span><span class="punctuation">(</span><span class="string">'recurse'</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre><p>With a task like this, the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a> might never stop - since every time it finishes one task run, another has appeared! So attempts to call the <a href="/api/tinytick/interfaces/manager/manager/methods/taskrun/scheduletaskrun/"><code>scheduleTaskRun</code></a> method when the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a> is stopping will return an undefined task run <a href="/api/tinytick/type-aliases/identity/id/"><code>Id</code></a> and nothing added to the schedule.</p><h3 id="summary">Summary</h3><p>OK, we&#x27;re done with looking at how the <a href="/api/tinytick/interfaces/manager/manager/"><code>Manager</code></a> can start and stop. And now you&#x27;ve learned about all of TinyTick&#x27;s functionality! We hope you&#x27;ve found these useful, and now you need to get out there and start using it.</p><p>To finish off, in the <a href="/guides/example-use-cases/">Example Use Cases</a> guides, we look at some common problems that TinyTick can solve.</p></section>